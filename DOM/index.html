<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Labyrinth</title>
  <meta name="description" content="Maze">
  <meta name="author" content="SitePoint">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<script type="text/javascript" charset="utf-8" src="js/Maze.js"></script>
<script type="text/javascript" charset="utf-8" src="js/Graph.js"></script>
<script type="text/javascript" charset="utf-8" src="js/Maze/Cell.js"></script>
<script type="text/javascript" charset="utf-8" src="js/Maze/Path.js"></script>
<script type="text/javascript" charset="utf-8" src="js/Maze/View.js"></script>
<script type="text/javascript" charset="utf-8" src="js/Maze/Ball.js"></script>
<div class="content">
<table>
  <tr>
    <td>Width:</td>
    <td><input type="text" value="5" id="width"></td>    
     <td>Start:</td>
    <td><input type="text" value="1,1" id="begin"></td> 
  </tr>
  <tr>
    <td>Height:</td>
    <td><input type="text" value="5" id="height"></td>
     <td>Finish:</td>
    <td><input type="text" value="5,5" id="end"></td>     
  </tr> 
  <tr>
    <td>Start:</td>
    <td><input type="text" value="1,1" id="start"></td>   
    <td>Timeout:</td>
    <td><input type="text" value="2" id="timeout"></td> 
  </tr>
  <tr>
    <td>Finish:</td>
    <td><input type="text" value="5,5" id="finish"></td>  
  </tr>
  <tr>
    <td>Possible Paths:</td>
    <td><input type="text" value="2" id="possiblePaths"></td>   
  </tr> 
</table>

<table>
   <tr>
    <td><button id = "generate" type="button">Generate maze</button></td>
    <td><button type="button" id="renderMaze">Render maze</button></td>    
    <td><button type="button" id="getPaths">Get paths</button></td>
    <td><button type="button" id="renderPath">Render path</button></td>   
  </tr>
</table>
<hr>
<div class="field" id="maze">  
</div>
</div>
<script>  	
 	  var maze = Maze.generate({
        width: 15,
        height: 15,
        possiblePaths: 3,
        start: {x:1, y:1},
        finish: {x:15, y:15}
    });

    var view = new Maze.View(document.querySelector('#maze'));  

    var ball = new Maze.Ball(document.querySelector('#maze'));

   /* view.render(maze);
     
    var paths = maze.getPaths({x:1, y:1}, {x:15, y:15});
  
    setTimeout(function () {
      view.render(paths[0]);
    }, 2000);
   
    setTimeout(function () {
      view.render(paths[1]);
    }, 4000);
  */
  
    function generateMaze(event) {
        var width = parseInt(document.getElementById('width').value, 10);
        var height = parseInt(document.getElementById('height').value, 10);
        var possiblePaths = parseInt(document.getElementById('possiblePaths').value, 10);
        var start = document.getElementById('start').value.split(",");
        var finish = document.getElementById('finish').value.split(",");
       
        maze = Maze.generate({
            width: width,
            height: height,
            possiblePaths: possiblePaths,
            start: {x: parseInt(start[0],10), y: parseInt(start[1],10)},
            finish: {x: parseInt(finish[0],10), y: parseInt(finish[1],10)}
        });      
     
    }
  
    function renderMaze(event) {
        view.render(maze);       
    }

    function getPaths(event) {
        var start = document.getElementById('begin').value.split(",");
        var finish = document.getElementById('end').value.split(",");

        start = {x: parseInt(start[0],10), y: parseInt(start[1],10)};
        finish = {x: parseInt(finish[0],10), y: parseInt(finish[1],10)};

        paths = maze.getPaths(start, finish);
        alert("Found " + paths.length + " paths");
    }

    var index = 0;

    function renderPath(event) {
        console.log(index);
        view.render(paths[index]);        
        //ball.startBall(paths[index]);
        ball.startBall(new Maze.Path({data: [{x: 2, y: 3}], maze: maze}));

        if (index < paths.length-1) {            
            index++;
        } else {
            index = 0;
        }

    } 
    
    var element;

    element = document.getElementById("generate");
    element.onclick = generateMaze;
    
    element = document.getElementById("renderMaze");
    element.onclick = renderMaze;
    
    element = document.getElementById("getPaths");
    element.onclick = getPaths;
    
    element = document.getElementById("renderPath");
    element.onclick = renderPath; 

</script>
</body>
</html>
